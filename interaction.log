 * Serving Flask app 'app' (lazy loading)
 * Environment: development
 * Debug mode: on
INFO:werkzeug: * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
INFO:werkzeug: * Restarting with stat
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 913-634-987
INFO:root:CRM INSTANCE CREATING ...
INFO:root:self._client_exists(action='crm.contact.list'): running ...

INFO:root:self._api(operation='crm.contact.list'): running ...
params=None

INFO:root:Bitrix.get_all(operation='crm.contact.list', params=None)
INFO:root:CRM._api() sets self._bx_responce={'contacts': []}

INFO:root:self._create(): Creating new client ...

INFO:root:self._bind_client_with_deal(client_exist=False): running ...

INFO:root:self._api(operation='crm.contact.add'): running ...
params="{'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn']}"

INFO:root:Bitrix.get_all(operation='crm.contact.add', params="{'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn']}")
INFO:root:CRM._api() sets self._bx_responce={'contacts': [{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn']}]}

INFO:root:self._api(operation='crm.deal.add'): running ...
params="{'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato'], 'delivery_adress': 'st. Mira, 211, Ekaterinburg', 'delivery_date': '2021-01-01:16:00', 'delivery_code': '#232nkF3fAdn'}"

INFO:root:Bitrix.get_all(operation='crm.deal.add', params="{'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato'], 'delivery_adress': 'st. Mira, 211, Ekaterinburg', 'delivery_date': '2021-01-01:16:00', 'delivery_code': '#232nkF3fAdn'}")
INFO:root:CRM._api() sets self._bx_responce={'deal': [{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato'], 'delivery_adress': 'st. Mira, 211, Ekaterinburg', 'delivery_date': '2021-01-01:16:00', 'delivery_code': '#232nkF3fAdn'}]}

INFO:werkzeug:127.0.0.1 - - [16/Oct/2021 20:11:28] "POST / HTTP/1.1" 200 -
INFO:root:CRM INSTANCE CREATING ...
INFO:root:self._client_exists(action='crm.contact.list'): running ...

INFO:root:self._api(operation='crm.contact.list'): running ...
params=None

INFO:root:Bitrix.get_all(operation='crm.contact.list', params=None)
INFO:root:CRM._api() sets self._bx_responce={'contacts': [{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn']}]}

INFO:root:self._update(): Updating None ...

INFO:root:self._deal_exists(action='crm.deal.list'): running ...

INFO:root:self._api(operation='crm.deal.list'): running ...
params=None

INFO:root:Bitrix.get_all(operation='crm.deal.list', params=None)
INFO:root:CRM._api() sets self._bx_responce={'deal': [{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato'], 'delivery_adress': 'st. Mira, 211, Ekaterinburg', 'delivery_date': '2021-01-01:16:00', 'delivery_code': '#232nkF3fAdn'}]}

INFO:root:self._update(): Updating deal ...

INFO:werkzeug:127.0.0.1 - - [16/Oct/2021 20:11:28] "POST / HTTP/1.1" 200 -
INFO:root:CRM INSTANCE CREATING ...
INFO:root:self._client_exists(action='crm.contact.list'): running ...

INFO:root:self._api(operation='crm.contact.list'): running ...
params=None

INFO:root:Bitrix.get_all(operation='crm.contact.list', params=None)
INFO:root:CRM._api() sets self._bx_responce={'contacts': [{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn']}]}

INFO:root:self._update(): Updating None ...

INFO:root:self._deal_exists(action='crm.deal.list'): running ...

INFO:root:self._api(operation='crm.deal.list'): running ...
params=None

INFO:root:Bitrix.get_all(operation='crm.deal.list', params=None)
INFO:root:CRM._api() sets self._bx_responce={'deal': [{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato'], 'delivery_adress': 'st. Mira, 211, Ekaterinburg', 'delivery_date': '2021-01-01:16:00', 'delivery_code': '#232nkF3fAdn'}]}

INFO:root:self._update(): Updating deal ...

INFO:root:self._update_fields(): running ...

INFO:root:self._api(operation='crm.deal.update'): running ...
params="{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato', 'Cheese'], 'delivery_adress': 'st. Mira, 221, Ekaterinburg', 'delivery_date': '2021-01-01:20:00', 'delivery_code': '#232nkF3fAdn'}"

INFO:root:Bitrix.get_all(operation='crm.deal.update', params="{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato', 'Cheese'], 'delivery_adress': 'st. Mira, 221, Ekaterinburg', 'delivery_date': '2021-01-01:20:00', 'delivery_code': '#232nkF3fAdn'}")
INFO:root:CRM._api() sets self._bx_responce={'deal': [{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato', 'Cheese'], 'delivery_adress': 'st. Mira, 221, Ekaterinburg', 'delivery_date': '2021-01-01:20:00', 'delivery_code': '#232nkF3fAdn'}]}

WARNING:root:None
INFO:werkzeug:127.0.0.1 - - [16/Oct/2021 20:11:28] "POST / HTTP/1.1" 200 -
INFO:root:CRM INSTANCE CREATING ...
INFO:root:self._client_exists(action='crm.contact.list'): running ...

INFO:root:self._api(operation='crm.contact.list'): running ...
params=None

INFO:root:Bitrix.get_all(operation='crm.contact.list', params=None)
INFO:root:CRM._api() sets self._bx_responce={'contacts': [{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn']}]}

INFO:root:self._create(): Creating new client ...

INFO:root:self._bind_client_with_deal(client_exist=False): running ...

INFO:root:self._api(operation='crm.contact.add'): running ...
params="{'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks', 'deal': ['#232nkF3ffoo']}"

INFO:root:Bitrix.get_all(operation='crm.contact.add', params="{'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks', 'deal': ['#232nkF3ffoo']}")
INFO:root:CRM._api() sets self._bx_responce={'contacts': [{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn']}, {'id': 2, 'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks', 'deal': ['#232nkF3ffoo']}]}

INFO:root:self._api(operation='crm.deal.add'): running ...
params="{'title': 'title', 'description': 'Some description', 'client': {'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks'}, 'products': ['Wine', 'Coffee', 'Fresh Blood'], 'delivery_adress': 'st. Mira, 212, Ekaterinburg', 'delivery_date': '2021-01-02:00:00', 'delivery_code': '#232nkF3ffoo'}"

INFO:root:Bitrix.get_all(operation='crm.deal.add', params="{'title': 'title', 'description': 'Some description', 'client': {'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks'}, 'products': ['Wine', 'Coffee', 'Fresh Blood'], 'delivery_adress': 'st. Mira, 212, Ekaterinburg', 'delivery_date': '2021-01-02:00:00', 'delivery_code': '#232nkF3ffoo'}")
INFO:root:CRM._api() sets self._bx_responce={'deal': [{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato', 'Cheese'], 'delivery_adress': 'st. Mira, 221, Ekaterinburg', 'delivery_date': '2021-01-01:20:00', 'delivery_code': '#232nkF3fAdn'}, {'id': 2, 'title': 'title', 'description': 'Some description', 'client': {'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks'}, 'products': ['Wine', 'Coffee', 'Fresh Blood'], 'delivery_adress': 'st. Mira, 212, Ekaterinburg', 'delivery_date': '2021-01-02:00:00', 'delivery_code': '#232nkF3ffoo'}]}

INFO:werkzeug:127.0.0.1 - - [16/Oct/2021 20:11:28] "POST / HTTP/1.1" 200 -
INFO:root:CRM INSTANCE CREATING ...
INFO:root:self._client_exists(action='crm.contact.list'): running ...

INFO:root:self._api(operation='crm.contact.list'): running ...
params=None

INFO:root:Bitrix.get_all(operation='crm.contact.list', params=None)
INFO:root:CRM._api() sets self._bx_responce={'contacts': [{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn']}, {'id': 2, 'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks', 'deal': ['#232nkF3ffoo']}]}

INFO:root:self._update(): Updating None ...

INFO:root:self._deal_exists(action='crm.deal.list'): running ...

INFO:root:self._api(operation='crm.deal.list'): running ...
params=None

INFO:root:Bitrix.get_all(operation='crm.deal.list', params=None)
INFO:root:CRM._api() sets self._bx_responce={'deal': [{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato', 'Cheese'], 'delivery_adress': 'st. Mira, 221, Ekaterinburg', 'delivery_date': '2021-01-01:20:00', 'delivery_code': '#232nkF3fAdn'}, {'id': 2, 'title': 'title', 'description': 'Some description', 'client': {'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks'}, 'products': ['Wine', 'Coffee', 'Fresh Blood'], 'delivery_adress': 'st. Mira, 212, Ekaterinburg', 'delivery_date': '2021-01-02:00:00', 'delivery_code': '#232nkF3ffoo'}]}

INFO:root:self._create(): Creating new deal ...

INFO:root:self._update(): Updating client ...

INFO:root:self._bind_client_with_deal(client_exist=True): running ...

INFO:root:self._api(operation='crm.contact.update'): running ...
params="{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn', '#232nkF3fbar']}"

INFO:root:Bitrix.get_all(operation='crm.contact.update', params="{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn', '#232nkF3fbar']}")
INFO:root:CRM._api() sets self._bx_responce={'contacts': [{'id': 1, 'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow', 'deal': ['#232nkF3fAdn', '#232nkF3fbar']}, {'id': 2, 'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks', 'deal': ['#232nkF3ffoo']}]}

INFO:root:self._api(operation='crm.deal.add'): running ...
params="{'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Milk'], 'delivery_adress': 'st. Mira, 211, Ekaterinburg', 'delivery_date': '2021-01-01:16:00', 'delivery_code': '#232nkF3fbar'}"

INFO:root:Bitrix.get_all(operation='crm.deal.add', params="{'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Milk'], 'delivery_adress': 'st. Mira, 211, Ekaterinburg', 'delivery_date': '2021-01-01:16:00', 'delivery_code': '#232nkF3fbar'}")
INFO:root:CRM._api() sets self._bx_responce={'deal': [{'id': 1, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Candy', 'Carrot', 'Potato', 'Cheese'], 'delivery_adress': 'st. Mira, 221, Ekaterinburg', 'delivery_date': '2021-01-01:20:00', 'delivery_code': '#232nkF3fAdn'}, {'id': 2, 'title': 'title', 'description': 'Some description', 'client': {'name': 'fj', 'surname': 'fj', 'phone': '+66677777777', 'adress': 'Forks'}, 'products': ['Wine', 'Coffee', 'Fresh Blood'], 'delivery_adress': 'st. Mira, 212, Ekaterinburg', 'delivery_date': '2021-01-02:00:00', 'delivery_code': '#232nkF3ffoo'}, {'id': 3, 'title': 'title', 'description': 'Some description', 'client': {'name': 'Jon', 'surname': 'Karter', 'phone': '+77777777777', 'adress': 'st. Mira, 287, Moscow'}, 'products': ['Milk'], 'delivery_adress': 'st. Mira, 211, Ekaterinburg', 'delivery_date': '2021-01-01:16:00', 'delivery_code': '#232nkF3fbar'}]}

INFO:werkzeug:127.0.0.1 - - [16/Oct/2021 20:11:28] "POST / HTTP/1.1" 200 -
CRM INSTANCE CREATING ...
self._update(): Updating currency ...

self._request(url='https://www.cbr-xml-daily.ru/daily_json.js'): running ...

self._save(): running ...

self._update_currency(): running ...

self._api(operation='crm.currency.update'): running ...
params='{"valutes": [{"id": 1, "fields": {"Valute": 82.7276}}, {"id": 2, "fields": {"Valute": 71.2371}}, {"id": 3, "fields": {"Valute": 16.7223}}, {"id": 4, "fields": {"Valute": 18.0901}}]}'

Bitrix.get_all(operation='crm.currency.update', params='{"valutes": [{"id": 1, "fields": {"Valute": 82.7276}}, {"id": 2, "fields": {"Valute": 71.2371}}, {"id": 3, "fields": {"Valute": 16.7223}}, {"id": 4, "fields": {"Valute": 18.0901}}]}')
CRM._api() sets self._bx_responce={'valutes': [{'id': 1, 'fields': {'Valute': 82.7276}}, {'id': 2, 'fields': {'Valute': 71.2371}}, {'id': 3, 'fields': {'Valute': 16.7223}}, {'id': 4, 'fields': {'Valute': 18.0901}}]}

